/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/parameter.py:283: UserWarning: Parameter "load_index_mapping_path" with value "None" is not of type string.
  warnings.warn('Parameter "{}" with value "{}" is not of type string.'.format(param_name, param_value))
2020-11-07 16:17:57,408 : INFO : logging configured by default settings
DEBUG: Checking if SupervisedModelTraining(project=mercado_livre.config.mercado_livre_transformer, sample_size=-1, minimum_interactions=5, session_test_size=0.1, test_size=0.1, dataset_split_method=column, test_split_type=random, val_size=0.1, n_splits=5, split_index=0, data_frames_preparation_extra_params={"sample_days": 30, "history_window": 10, "column_stratification": "SessionID", "filter_only_buy": true}, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, observation=new1, load_index_mapping_path=None, negative_proportion=0.0, recommender_module_class=model.MLTransformerModel, recommender_extra_params={"n_factors": 100, "n_hid": 100, "n_head": 1, "n_layers": 1, "num_filters": 50, "dropout": 0.2, "hist_size": 10, "from_index_mapping": false, "path_item_embedding": false, "freeze_embedding": false}, device=cuda, batch_size=512, epochs=1000, optimizer=radam, optimizer_params={"weight_decay": 0}, learning_rate=0.001, loss_function=ce, loss_function_params={}, gradient_norm_clipping=0.0, gradient_norm_clipping_type=2, early_stopping_patience=5, early_stopping_min_delta=0.001, monitor_metric=val_loss, monitor_mode=min, generator_workers=10, pin_memory=False, policy_estimator_extra_params={}, sample_size_eval=2000, metrics=["loss"], bandit_policy_class=mars_gym.model.bandit.ModelPolicy, bandit_policy_params={}) is complete
2020-11-07 16:17:57,411 : DEBUG : Checking if SupervisedModelTraining(project=mercado_livre.config.mercado_livre_transformer, sample_size=-1, minimum_interactions=5, session_test_size=0.1, test_size=0.1, dataset_split_method=column, test_split_type=random, val_size=0.1, n_splits=5, split_index=0, data_frames_preparation_extra_params={"sample_days": 30, "history_window": 10, "column_stratification": "SessionID", "filter_only_buy": true}, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, observation=new1, load_index_mapping_path=None, negative_proportion=0.0, recommender_module_class=model.MLTransformerModel, recommender_extra_params={"n_factors": 100, "n_hid": 100, "n_head": 1, "n_layers": 1, "num_filters": 50, "dropout": 0.2, "hist_size": 10, "from_index_mapping": false, "path_item_embedding": false, "freeze_embedding": false}, device=cuda, batch_size=512, epochs=1000, optimizer=radam, optimizer_params={"weight_decay": 0}, learning_rate=0.001, loss_function=ce, loss_function_params={}, gradient_norm_clipping=0.0, gradient_norm_clipping_type=2, early_stopping_patience=5, early_stopping_min_delta=0.001, monitor_metric=val_loss, monitor_mode=min, generator_workers=10, pin_memory=False, policy_estimator_extra_params={}, sample_size_eval=2000, metrics=["loss"], bandit_policy_class=mars_gym.model.bandit.ModelPolicy, bandit_policy_params={}) is complete
/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/parameter.py:283: UserWarning: Parameter "index_mapping_path" with value "None" is not of type string.
  warnings.warn('Parameter "{}" with value "{}" is not of type string.'.format(param_name, param_value))
DEBUG: Checking if SessionInteractionDataFrame(session_test_size=0.1, test_size=0.1, sample_size=-1, minimum_interactions=5, dataset_split_method=column, column_stratification=SessionID, test_split_type=random, item_column=ItemID, available_arms_column_name=, n_splits=5, split_index=0, val_size=0.1, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, sample_days=30, history_window=10, size_available_list=100, days_test=1, index_mapping_path=None, filter_only_buy=True) is complete
2020-11-07 16:17:57,449 : DEBUG : Checking if SessionInteractionDataFrame(session_test_size=0.1, test_size=0.1, sample_size=-1, minimum_interactions=5, dataset_split_method=column, column_stratification=SessionID, test_split_type=random, item_column=ItemID, available_arms_column_name=, n_splits=5, split_index=0, val_size=0.1, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, sample_days=30, history_window=10, size_available_list=100, days_test=1, index_mapping_path=None, filter_only_buy=True) is complete
INFO: Informed scheduler that task   SupervisedModelTraining____mars_gym_model_b____b7e287556f   has status   PENDING
2020-11-07 16:17:57,451 : INFO : Informed scheduler that task   SupervisedModelTraining____mars_gym_model_b____b7e287556f   has status   PENDING
DEBUG: Checking if SessionPrepareDataset(sample_days=30, history_window=10, size_available_list=100, minimum_interactions=5, min_session_size=2, no_filter_data=False) is complete
2020-11-07 16:17:57,452 : DEBUG : Checking if SessionPrepareDataset(sample_days=30, history_window=10, size_available_list=100, minimum_interactions=5, min_session_size=2, no_filter_data=False) is complete
INFO: Informed scheduler that task   SessionInteractionDataFrame_____SessionID_3a1f79aed4   has status   PENDING
2020-11-07 16:17:57,453 : INFO : Informed scheduler that task   SessionInteractionDataFrame_____SessionID_3a1f79aed4   has status   PENDING
DEBUG: Checking if PreProcessSessionDataset() is complete
2020-11-07 16:17:57,453 : DEBUG : Checking if PreProcessSessionDataset() is complete
INFO: Informed scheduler that task   SessionPrepareDataset_10_2_5_741e44cb1e   has status   PENDING
2020-11-07 16:17:57,454 : INFO : Informed scheduler that task   SessionPrepareDataset_10_2_5_741e44cb1e   has status   PENDING
INFO: Informed scheduler that task   PreProcessSessionDataset__99914b932b   has status   DONE
2020-11-07 16:17:57,454 : INFO : Informed scheduler that task   PreProcessSessionDataset__99914b932b   has status   DONE
INFO: Done scheduling tasks
2020-11-07 16:17:57,454 : INFO : Done scheduling tasks
INFO: Running Worker with 1 processes
2020-11-07 16:17:57,454 : INFO : Running Worker with 1 processes
DEBUG: Asking scheduler for work...
2020-11-07 16:17:57,455 : DEBUG : Asking scheduler for work...
DEBUG: Pending tasks: 3
2020-11-07 16:17:57,455 : DEBUG : Pending tasks: 3
INFO: [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) running   SessionPrepareDataset(sample_days=30, history_window=10, size_available_list=100, minimum_interactions=5, min_session_size=2, no_filter_data=False)
2020-11-07 16:17:57,455 : INFO : [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) running   SessionPrepareDataset(sample_days=30, history_window=10, size_available_list=100, minimum_interactions=5, min_session_size=2, no_filter_data=False)
INFO: Running command: spark-submit --master local[*] --deploy-mode client --name SessionPrepareDataset --driver-memory 2g /home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/contrib/pyspark_runner.py /tmp/SessionPrepareDatasetriyi7ael/SessionPrepareDataset.pickle
2020-11-07 16:17:57,523 : INFO : Running command: spark-submit --master local[*] --deploy-mode client --name SessionPrepareDataset --driver-memory 2g /home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/contrib/pyspark_runner.py /tmp/SessionPrepareDatasetriyi7ael/SessionPrepareDataset.pickle
INFO: Program stdout:
filter date 3768368
filter date 3023709
2019-10-02 00:00:00 2019-11-01 00:00:00
Filter minin interactions 86424
Filter session size 330004
+-----------+-------+-------------------+----------+
|  SessionID| ItemID|          Timestamp|event_type|
+-----------+-------+-------------------+----------+
|      14003|1433166|2019-10-02 00:00:00|       buy|
|      14201|1834627|2019-10-02 00:00:00|       buy|
|      15846|1938136|2019-10-02 00:00:00|       buy|
|17179872557| 906502|2019-10-02 00:00:00|       buy|
|17179881365| 977652|2019-10-02 00:00:00|       buy|
|17179885717| 263977|2019-10-02 00:00:00|       buy|
|17179890251|1942939|2019-10-02 00:00:00|       buy|
|17179892124|1784647|2019-10-02 00:00:00|       buy|
|17179897894|1532415|2019-10-02 00:00:00|       buy|
|17179898385| 176716|2019-10-02 00:00:00|       buy|
|17179900520| 325792|2019-10-02 00:00:00|       buy|
|      20618| 539175|2019-10-02 00:00:00|       buy|
|      20819|1183615|2019-10-02 00:00:00|       buy|
|      21970|1449202|2019-10-02 00:00:00|       buy|
|      23707|1644076|2019-10-02 00:00:00|       buy|
|25769810303|1175894|2019-10-02 00:00:00|       buy|
|25769811863| 719226|2019-10-02 00:00:00|       buy|
|25769816857| 714980|2019-10-02 00:00:00|       buy|
|25769818691| 169078|2019-10-02 00:00:00|       buy|
|25769819943|1160623|2019-10-02 00:00:00|       buy|
|25769820217| 268978|2019-10-02 00:00:00|       buy|
|25769820914|1937058|2019-10-02 00:00:00|       buy|
|25769822825| 423506|2019-10-02 00:00:00|       buy|
|25769823427| 349601|2019-10-02 00:00:00|       buy|
|25769826768|1613828|2019-10-02 00:00:00|       buy|
|25769832927|1979875|2019-10-02 00:00:00|       buy|
|25769837498| 259763|2019-10-02 00:00:00|       buy|
|       2736|1276951|2019-10-02 00:00:00|       buy|
|       3013| 815994|2019-10-02 00:00:00|       buy|
|      31126|  38837|2019-10-02 00:00:00|       buy|
|      32011|  95238|2019-10-02 00:00:00|       buy|
|      33029| 649372|2019-10-02 00:00:00|       buy|
|34359746569| 796152|2019-10-02 00:00:00|       buy|
|34359748246|2038252|2019-10-02 00:00:00|       buy|
|34359753307| 832216|2019-10-02 00:00:00|       buy|
|34359753543|1654929|2019-10-02 00:00:00|       buy|
|34359759306|1529841|2019-10-02 00:00:00|       buy|
|34359767542| 170359|2019-10-02 00:00:00|       buy|
|34359767707|   4054|2019-10-02 00:00:00|       buy|
|34359771683|1846380|2019-10-02 00:00:00|       buy|
|34359771983| 629351|2019-10-02 00:00:00|       buy|
|       3493|  89586|2019-10-02 00:00:00|       buy|
|42949680323| 616235|2019-10-02 00:00:00|       buy|
|42949681416| 250967|2019-10-02 00:00:00|       buy|
|42949686356|1860104|2019-10-02 00:00:00|       buy|
|42949688728| 824954|2019-10-02 00:00:00|       buy|
|42949694759| 125548|2019-10-02 00:00:00|       buy|
|42949694766| 413266|2019-10-02 00:00:00|       buy|
|42949699754| 596359|2019-10-02 00:00:00|       buy|
|42949700395| 337869|2019-10-02 00:00:00|       buy|
+-----------+-------+-------------------+----------+
only showing top 50 rows

None

2020-11-07 16:26:37,792 : INFO : Program stdout:
filter date 3768368
filter date 3023709
2019-10-02 00:00:00 2019-11-01 00:00:00
Filter minin interactions 86424
Filter session size 330004
+-----------+-------+-------------------+----------+
|  SessionID| ItemID|          Timestamp|event_type|
+-----------+-------+-------------------+----------+
|      14003|1433166|2019-10-02 00:00:00|       buy|
|      14201|1834627|2019-10-02 00:00:00|       buy|
|      15846|1938136|2019-10-02 00:00:00|       buy|
|17179872557| 906502|2019-10-02 00:00:00|       buy|
|17179881365| 977652|2019-10-02 00:00:00|       buy|
|17179885717| 263977|2019-10-02 00:00:00|       buy|
|17179890251|1942939|2019-10-02 00:00:00|       buy|
|17179892124|1784647|2019-10-02 00:00:00|       buy|
|17179897894|1532415|2019-10-02 00:00:00|       buy|
|17179898385| 176716|2019-10-02 00:00:00|       buy|
|17179900520| 325792|2019-10-02 00:00:00|       buy|
|      20618| 539175|2019-10-02 00:00:00|       buy|
|      20819|1183615|2019-10-02 00:00:00|       buy|
|      21970|1449202|2019-10-02 00:00:00|       buy|
|      23707|1644076|2019-10-02 00:00:00|       buy|
|25769810303|1175894|2019-10-02 00:00:00|       buy|
|25769811863| 719226|2019-10-02 00:00:00|       buy|
|25769816857| 714980|2019-10-02 00:00:00|       buy|
|25769818691| 169078|2019-10-02 00:00:00|       buy|
|25769819943|1160623|2019-10-02 00:00:00|       buy|
|25769820217| 268978|2019-10-02 00:00:00|       buy|
|25769820914|1937058|2019-10-02 00:00:00|       buy|
|25769822825| 423506|2019-10-02 00:00:00|       buy|
|25769823427| 349601|2019-10-02 00:00:00|       buy|
|25769826768|1613828|2019-10-02 00:00:00|       buy|
|25769832927|1979875|2019-10-02 00:00:00|       buy|
|25769837498| 259763|2019-10-02 00:00:00|       buy|
|       2736|1276951|2019-10-02 00:00:00|       buy|
|       3013| 815994|2019-10-02 00:00:00|       buy|
|      31126|  38837|2019-10-02 00:00:00|       buy|
|      32011|  95238|2019-10-02 00:00:00|       buy|
|      33029| 649372|2019-10-02 00:00:00|       buy|
|34359746569| 796152|2019-10-02 00:00:00|       buy|
|34359748246|2038252|2019-10-02 00:00:00|       buy|
|34359753307| 832216|2019-10-02 00:00:00|       buy|
|34359753543|1654929|2019-10-02 00:00:00|       buy|
|34359759306|1529841|2019-10-02 00:00:00|       buy|
|34359767542| 170359|2019-10-02 00:00:00|       buy|
|34359767707|   4054|2019-10-02 00:00:00|       buy|
|34359771683|1846380|2019-10-02 00:00:00|       buy|
|34359771983| 629351|2019-10-02 00:00:00|       buy|
|       3493|  89586|2019-10-02 00:00:00|       buy|
|42949680323| 616235|2019-10-02 00:00:00|       buy|
|42949681416| 250967|2019-10-02 00:00:00|       buy|
|42949686356|1860104|2019-10-02 00:00:00|       buy|
|42949688728| 824954|2019-10-02 00:00:00|       buy|
|42949694759| 125548|2019-10-02 00:00:00|       buy|
|42949694766| 413266|2019-10-02 00:00:00|       buy|
|42949699754| 596359|2019-10-02 00:00:00|       buy|
|42949700395| 337869|2019-10-02 00:00:00|       buy|
+-----------+-------+-------------------+----------+
only showing top 50 rows

None

INFO: [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) done      SessionPrepareDataset(sample_days=30, history_window=10, size_available_list=100, minimum_interactions=5, min_session_size=2, no_filter_data=False)
2020-11-07 16:26:37,824 : INFO : [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) done      SessionPrepareDataset(sample_days=30, history_window=10, size_available_list=100, minimum_interactions=5, min_session_size=2, no_filter_data=False)
DEBUG: 1 running tasks, waiting for next task to finish
2020-11-07 16:26:37,847 : DEBUG : 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   SessionPrepareDataset_10_2_5_741e44cb1e   has status   DONE
2020-11-07 16:26:37,872 : INFO : Informed scheduler that task   SessionPrepareDataset_10_2_5_741e44cb1e   has status   DONE
DEBUG: Asking scheduler for work...
2020-11-07 16:26:37,873 : DEBUG : Asking scheduler for work...
DEBUG: Pending tasks: 2
2020-11-07 16:26:37,879 : DEBUG : Pending tasks: 2
INFO: [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) running   SessionInteractionDataFrame(session_test_size=0.1, test_size=0.1, sample_size=-1, minimum_interactions=5, dataset_split_method=column, column_stratification=SessionID, test_split_type=random, item_column=ItemID, available_arms_column_name=, n_splits=5, split_index=0, val_size=0.1, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, sample_days=30, history_window=10, size_available_list=100, days_test=1, index_mapping_path=None, filter_only_buy=True)
2020-11-07 16:26:37,880 : INFO : [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) running   SessionInteractionDataFrame(session_test_size=0.1, test_size=0.1, sample_size=-1, minimum_interactions=5, dataset_split_method=column, column_stratification=SessionID, test_split_type=random, item_column=ItemID, available_arms_column_name=, n_splits=5, split_index=0, val_size=0.1, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, sample_days=30, history_window=10, size_available_list=100, days_test=1, index_mapping_path=None, filter_only_buy=True)
INFO: [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) done      SessionInteractionDataFrame(session_test_size=0.1, test_size=0.1, sample_size=-1, minimum_interactions=5, dataset_split_method=column, column_stratification=SessionID, test_split_type=random, item_column=ItemID, available_arms_column_name=, n_splits=5, split_index=0, val_size=0.1, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, sample_days=30, history_window=10, size_available_list=100, days_test=1, index_mapping_path=None, filter_only_buy=True)
2020-11-07 16:26:55,841 : INFO : [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) done      SessionInteractionDataFrame(session_test_size=0.1, test_size=0.1, sample_size=-1, minimum_interactions=5, dataset_split_method=column, column_stratification=SessionID, test_split_type=random, item_column=ItemID, available_arms_column_name=, n_splits=5, split_index=0, val_size=0.1, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, sample_days=30, history_window=10, size_available_list=100, days_test=1, index_mapping_path=None, filter_only_buy=True)
DEBUG: 1 running tasks, waiting for next task to finish
2020-11-07 16:26:55,842 : DEBUG : 1 running tasks, waiting for next task to finish
INFO: Informed scheduler that task   SessionInteractionDataFrame_____SessionID_3a1f79aed4   has status   DONE
2020-11-07 16:26:55,842 : INFO : Informed scheduler that task   SessionInteractionDataFrame_____SessionID_3a1f79aed4   has status   DONE
DEBUG: Asking scheduler for work...
2020-11-07 16:26:55,842 : DEBUG : Asking scheduler for work...
DEBUG: Pending tasks: 1
2020-11-07 16:26:55,843 : DEBUG : Pending tasks: 1
INFO: [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) running   SupervisedModelTraining(project=mercado_livre.config.mercado_livre_transformer, sample_size=-1, minimum_interactions=5, session_test_size=0.1, test_size=0.1, dataset_split_method=column, test_split_type=random, val_size=0.1, n_splits=5, split_index=0, data_frames_preparation_extra_params={"sample_days": 30, "history_window": 10, "column_stratification": "SessionID", "filter_only_buy": true}, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, observation=new1, load_index_mapping_path=None, negative_proportion=0.0, recommender_module_class=model.MLTransformerModel, recommender_extra_params={"n_factors": 100, "n_hid": 100, "n_head": 1, "n_layers": 1, "num_filters": 50, "dropout": 0.2, "hist_size": 10, "from_index_mapping": false, "path_item_embedding": false, "freeze_embedding": false}, device=cuda, batch_size=512, epochs=1000, optimizer=radam, optimizer_params={"weight_decay": 0}, learning_rate=0.001, loss_function=ce, loss_function_params={}, gradient_norm_clipping=0.0, gradient_norm_clipping_type=2, early_stopping_patience=5, early_stopping_min_delta=0.001, monitor_metric=val_loss, monitor_mode=min, generator_workers=10, pin_memory=False, policy_estimator_extra_params={}, sample_size_eval=2000, metrics=["loss"], bandit_policy_class=mars_gym.model.bandit.ModelPolicy, bandit_policy_params={})
2020-11-07 16:26:55,843 : INFO : [pid 568177] Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) running   SupervisedModelTraining(project=mercado_livre.config.mercado_livre_transformer, sample_size=-1, minimum_interactions=5, session_test_size=0.1, test_size=0.1, dataset_split_method=column, test_split_type=random, val_size=0.1, n_splits=5, split_index=0, data_frames_preparation_extra_params={"sample_days": 30, "history_window": 10, "column_stratification": "SessionID", "filter_only_buy": true}, sampling_strategy=none, balance_fields=[], sampling_proportions={}, use_sampling_in_validation=False, eq_filters={}, neq_filters={}, isin_filters={}, seed=42, observation=new1, load_index_mapping_path=None, negative_proportion=0.0, recommender_module_class=model.MLTransformerModel, recommender_extra_params={"n_factors": 100, "n_hid": 100, "n_head": 1, "n_layers": 1, "num_filters": 50, "dropout": 0.2, "hist_size": 10, "from_index_mapping": false, "path_item_embedding": false, "freeze_embedding": false}, device=cuda, batch_size=512, epochs=1000, optimizer=radam, optimizer_params={"weight_decay": 0}, learning_rate=0.001, loss_function=ce, loss_function_params={}, gradient_norm_clipping=0.0, gradient_norm_clipping_type=2, early_stopping_patience=5, early_stopping_min_delta=0.001, monitor_metric=val_loss, monitor_mode=min, generator_workers=10, pin_memory=False, policy_estimator_extra_params={}, sample_size_eval=2000, metrics=["loss"], bandit_policy_class=mars_gym.model.bandit.ModelPolicy, bandit_policy_params={})
index_mapping...
train_data_frame:
  0%|          | 0/196253 [00:00<?, ?it/s]100%|██████████| 196253/196253 [00:00<00:00, 5275926.28it/s]
  0%|          | 0/196253 [00:00<?, ?it/s]100%|██████████| 196253/196253 [00:00<00:00, 4328513.44it/s]val_data_frame:

  0%|          | 0/21743 [00:00<?, ?it/s]100%|██████████| 21743/21743 [00:00<00:00, 4737739.72it/s]
  0%|          | 0/21743 [00:00<?, ?it/s]100%|██████████| 21743/21743 [00:00<00:00, 4556875.62it/s]indexing project_all_columns...
indexing create_index_mapping_from_arrays...
indexing same_index_as...
transform_with_indexing...

transform_with_indexing...
Process ForkPoolWorker-71:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-65:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-76:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-66:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-73:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-74:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-68:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-75:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-70:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-72:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
Process ForkPoolWorker-69:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 335, in get
    res = self._reader.recv_bytes()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/connection.py", line 216, in recv_bytes
    buf = self._recv_bytes(maxlength)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/connection.py", line 407, in _recv_bytes
    buf = self._recv(4)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/connection.py", line 379, in _recv
    chunk = read(handle, remaining)
KeyboardInterrupt
Process ForkPoolWorker-67:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 258, in _bootstrap
    self.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 93, in run
    self._target(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 108, in worker
    task = get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/queues.py", line 334, in get
    with self._rlock:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/synchronize.py", line 95, in __enter__
    return self._semlock.__enter__()
KeyboardInterrupt
INFO: Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) was stopped. Shutting down Keep-Alive thread
2020-11-07 16:27:12,579 : INFO : Worker Worker(salt=779783423, workers=1, host=marlesson-pc, username=marlesson, pid=568177) was stopped. Shutting down Keep-Alive thread
Traceback (most recent call last):
  File "/media/workspace/mars-gym/src/mars_gym/utils/index_mapping.py", line 58, in transform_with_indexing
    df[key] = pool.map(functools.partial(map_array, mapping=mapping), df[key])
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 266, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 638, in get
    self.wait(timeout)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 635, in wait
    self._event.wait(timeout)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/threading.py", line 551, in wait
    signaled = self._cond.wait(timeout)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/threading.py", line 295, in wait
    waiter.acquire()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/bin/luigi", line 8, in <module>
    sys.exit(luigi_run())
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/cmdline.py", line 9, in luigi_run
    run_with_retcodes(argv)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/retcodes.py", line 75, in run_with_retcodes
    worker = luigi.interface._run(argv).worker
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/interface.py", line 211, in _run
    return _schedule_and_run([cp.get_task_obj()], worker_scheduler_factory)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/interface.py", line 173, in _schedule_and_run
    success &= worker.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/worker.py", line 1215, in run
    self._run_task(get_work_response.task_id)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/worker.py", line 1019, in _run_task
    task_process.run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/worker.py", line 293, in run
    super(ContextManagedTaskProcess, self).run()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/worker.py", line 199, in run
    new_deps = self._run_get_new_deps()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/site-packages/luigi/worker.py", line 141, in _run_get_new_deps
    task_gen = self.task.run()
  File "/media/workspace/mars-gym/src/mars_gym/simulation/training.py", line 506, in run
    self.before_run()
  File "/media/workspace/mars-gym/src/mars_gym/simulation/training.py", line 499, in before_run
    self.val_data_frame
  File "/media/workspace/mars-gym/src/mars_gym/simulation/training.py", line 312, in val_data_frame
    self._val_data_frame, self.index_mapping, self.project_config
  File "/media/workspace/mars-gym/src/mars_gym/utils/index_mapping.py", line 58, in transform_with_indexing
    df[key] = pool.map(functools.partial(map_array, mapping=mapping), df[key])
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 611, in __exit__
    self.terminate()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 541, in terminate
    self._terminate()
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/util.py", line 186, in __call__
    res = self._callback(*self._args, **self._kwargs)
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 571, in _terminate_pool
    cls._help_stuff_finish(inqueue, task_handler, len(pool))
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/pool.py", line 556, in _help_stuff_finish
    inqueue._rlock.acquire()
KeyboardInterrupt

Aborted!
Error in atexit._run_exitfuncs:
Traceback (most recent call last):
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/util.py", line 298, in _exit_function
    if current_process() is not None:
  File "/home/marlesson/anaconda3/envs/triplet-session/lib/python3.6/multiprocessing/process.py", line 35, in current_process
    def current_process():
KeyboardInterrupt
